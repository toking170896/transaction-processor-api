basePath: /api/v1
definitions:
  transaction-processor_internal_model.BalanceResponse:
    properties:
      balance:
        example: "100.50"
        type: string
      user_id:
        example: 1
        type: integer
    type: object
  transaction-processor_internal_model.ErrorResponse:
    properties:
      code:
        example: INSUFFICIENT_BALANCE
        type: string
      details:
        type: string
      error:
        example: insufficient balance
        type: string
    type: object
  transaction-processor_internal_model.SourceType:
    enum:
    - game
    - server
    - payment
    type: string
    x-enum-varnames:
    - SourceGame
    - SourceServer
    - SourcePayment
  transaction-processor_internal_model.State:
    enum:
    - win
    - lost
    type: string
    x-enum-varnames:
    - StateWin
    - StateLost
  transaction-processor_internal_model.Transaction:
    properties:
      amount:
        type: number
      cancelled_at:
        type: string
      created_at:
        type: string
      id:
        type: integer
      source_type:
        $ref: '#/definitions/transaction-processor_internal_model.SourceType'
      state:
        $ref: '#/definitions/transaction-processor_internal_model.State'
      status:
        $ref: '#/definitions/transaction-processor_internal_model.TransactionStatus'
      transaction_id:
        type: string
      updated_at:
        type: string
      user_id:
        type: integer
    type: object
  transaction-processor_internal_model.TransactionListResponse:
    properties:
      limit:
        type: integer
      offset:
        type: integer
      total:
        type: integer
      transactions:
        items:
          $ref: '#/definitions/transaction-processor_internal_model.Transaction'
        type: array
    type: object
  transaction-processor_internal_model.TransactionRequest:
    properties:
      amount:
        example: "10.15"
        type: string
      state:
        enum:
        - win
        - lost
        example: win
        type: string
      transaction_id:
        example: 550e8400-e29b-41d4-a716-446655440000
        type: string
    required:
    - amount
    - state
    - transaction_id
    type: object
  transaction-processor_internal_model.TransactionResponse:
    properties:
      balance:
        example: "110.15"
        type: string
      message:
        example: Transaction processed successfully
        type: string
      status:
        example: success
        type: string
    type: object
  transaction-processor_internal_model.TransactionStatus:
    enum:
    - processed
    - cancelled
    type: string
    x-enum-varnames:
    - StatusProcessed
    - StatusCancelled
host: localhost:8080
info:
  contact: {}
  description: API for processing third-party provider transactions
  title: Transaction Processor API
  version: "1.0"
paths:
  /transactions:
    post:
      consumes:
      - application/json
      description: Process a win/lost transaction from third-party provider
      parameters:
      - description: Source type
        enum:
        - game
        - server
        - payment
        in: header
        name: Source-Type
        required: true
        type: string
      - description: User ID
        in: query
        name: user_id
        required: true
        type: integer
      - description: Transaction details
        in: body
        name: transaction
        required: true
        schema:
          $ref: '#/definitions/transaction-processor_internal_model.TransactionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Already processed
          schema:
            $ref: '#/definitions/transaction-processor_internal_model.TransactionResponse'
        "201":
          description: Created
          schema:
            $ref: '#/definitions/transaction-processor_internal_model.TransactionResponse'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/transaction-processor_internal_model.ErrorResponse'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/transaction-processor_internal_model.ErrorResponse'
      summary: Process a transaction
      tags:
      - transactions
  /transactions/user/{id}:
    get:
      description: Returns a paginated list of transactions for a user
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: integer
      - default: 10
        description: Limit
        in: query
        name: limit
        type: integer
      - default: 0
        description: Offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/transaction-processor_internal_model.TransactionListResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/transaction-processor_internal_model.ErrorResponse'
      summary: Get user transactions
      tags:
      - transactions
  /users/{id}/balance:
    get:
      description: Returns the current balance for a user
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/transaction-processor_internal_model.BalanceResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/transaction-processor_internal_model.ErrorResponse'
      summary: Get user balance
      tags:
      - users
swagger: "2.0"
